<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
    <title>Notification</title>
  </head>
  <body>
    <button>Show Alert</button>
    <div class="notification" id="mm-notification"></div>

    <!-- <div class="mm-notification-alert hide mm-notification-info-alert">
      <span class="fas fa-exclamation-circle"></span>
      <div class="msg">
        <strong>Warning!</strong>
        <br />
        <span class="msg-desc">This is a warning alert!</span>
      </div>
      <div class="close-btn">
        <span class="fas fa-times close-icon"></span>
      </div>
    </div> -->

    <script>
      let data = `<div class="mm-notification-alert show showAlert mm-notification-info-alert">
      <span class="fas fa-exclamation-circle"></span>
      <div class="msg">
        <strong>Warning!</strong>
        <br />
        <span class="msg-desc">This is a warning alert!</span>
      </div>
      <div class="close-btn">
        <span class="fas fa-times close-icon"></span>
      </div>
    </div>`;

      const notificationId = $('#mm-notification');
      const notificationKey = 'mm-notification-key-';
      const numberOfNotification = 6;
      let notificationIndex = 1;

      class Notification {
        information(message, unitqueId, title = "Information!") {
          return this.prepare(message, title, unitqueId);
        }

        warning(message, unitqueId, title = "Warning!") {
          return this.prepare( message, title, unitqueId);
        }

        success(message, unitqueId, title = "Success!") {
          return this.prepare(message, title, unitqueId);
        }

        error(message, unitqueId, title = "Error!") {
          return this.prepare(message, title, unitqueId);
        }

        prepare(message, title, unitqueId) {
          return `<div class="mm-notification-alert show showAlert mm-notification-info-alert" id="${unitqueId}">
                        <span class="fas fa-exclamation-circle"></span>
                        <div class="msg"><strong>${title}</strong><br/><span class="msg-desc">${message}</span></div>
                        <div class="close-btn"><span class="fas fa-times close-icon"></span></div>
                  </div>`;
        }
      }

      let notification = new Notification();


      $("button").click(function () {
        
        $(notificationId).empty();

        notificationIndex = 1;

        for(let i = 1; i < numberOfNotification; i++) {

            work('This is a waring message-'+i, i);
        }

      });


      function work(message, i){

           const workTimer = setTimeout(function(){

               let key = notificationKey+i;

               let keySelector = $('#'+key);

               $(notificationId).append(notification.warning(message, key));
   
               $(keySelector).find('.close-btn').click(function(){
                  $(keySelector).removeClass("show");
                  $(keySelector).addClass("hide");
               })

               notificationIndex += 1;

               if(notificationIndex === numberOfNotification) {
                  workDone();
               }

               clearTimeout(workTimer);

            }, 1000 * i);
      }


      function workDone(){

         let messages = $(notificationId).children();

         $.each(messages, function(index, value){
            RemoveElement(index+1);
         });

      }

      $(notificationId).on('click', '.close-btn', function(e){
         e.preventDefault();
         if(!$(e.currentTarget).parent().hasClass('mm-notification-alert')) return;
         $(e.currentTarget).parents('.mm-notification-alert').removeClass('show').addClass('hide');
         const timer = setTimeout(() => {
            $(e.currentTarget).parents('.mm-notification-alert').remove();
            clearTimeout(timer);
         }, 1300);
      });

      function RemoveElement(index) {
         const timer = setTimeout(() => {
            $(`#${notificationKey}${index}`).removeClass('show').addClass('hide');
            clearTimeout(timer);
         }, 1300 * index);
      }

    </script>
  </body>
</html>
